# -*- coding: utf-8 -*-
"""AI_LAB10_Textrank.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1RQizCAhEx82GhfUC_b4iltPXEg8D9-kF

Textrank for documentation summarization
"""

import numpy as np
import pandas as pd
import nltk
from nltk.tokenize import sent_tokenize
import re

text="That break-through inningsâ€¦ We remember the accolades, but where did it all begin? There's always the one innings that made the world sit up and take notice; the 86-ball knock which he started off as a brash boy, but ended as a man. Chasing an improbable target of 321 off 40 overs to stay alive in the tournament, he laid into the Sri Lankan bowlers and carted his way to 133*, getting India home with more than 2 overs to spare, practically pulling them out of the airport after M.S. Dhoni rather ignorantly remarked that India had already been eliminated from the tournament.King Kohli had arrived. The king of the run-chase, and a plethora of ODI records in the modern age.Batting technique and idiosyncrasiesKohli has a seemingly hot head on his shoulders, but he channels all his anger while he is batting. Known to be an aggressive batsman always on the lookout for runs, he has a fairly sound , albeit slightly unconventional technique, which makes him judge the length of the ball earlier than most, and amazingly quick wrists to run his hands through the ball, even against fast bowlers. He is equally adept against pace and spin, and never looks ungainly at the crease. With nimble foot-movement against the spinners, he is known to be quite destructive when the situation demands it. He has had to fill some rather big shoes of his predecessors, and has done an admirable job to say the least.Captaincy and a change in techniqueWith regular captain MS Dhoni ailing from an injury, Kohli was named stand-in captain for the first Test at Adelaide. After an abysmal tour of England, critics were sceptical of Kohli's performance in Australia in the Border-Gavaskar trophy in December. Kohli proved that they couldn't have been more wrong, as he scored two fluent hundreds in the first Test at Adelaide. His second innings masterclass of 141 almost pulled off a stunning run-chase on a notorious 5th day rank-turner, and went on to score a total of four hundreds on this tour. Saying that he had silenced critics would be an understatement.As India prepared for their title defence ahead of the 2015 World Cup Down Under, with the catch phrase 'Won't give it back' doing the rounds, Virat Kohli was touted to be a key performer for India. The Indians had a terrible run in Australia, having failed to win a single match in the Test series as well as the succeeding ODI tri-series. Kohli started off in signature fashion, with a typically stroke-filled hundred against Pakistan as India maintained their unbeaten run against their arch-rivals in ICC events. As India stormed into the semi-finals unbeaten, Kohli's form continued to take an uncharacteristic dip, culminating in a painstaking 1 in the semi-final loss against the co-hosts and eventual champions, Australia."

import nltk
nltk.download('punkt')

sentences=sent_tokenize(text)

#clean our document
clean_sentences=pd.Series(sentences).str.replace("[^a-zA-Z]"," ")
clean_sentences=[s.lower() for s in clean_sentences]

nltk.download("stopwords")

from nltk.corpus import stopwords
stop_words=stopwords.words("english")

def remove_stopwords(sentence):
  return(" ".join([i for i in sentence if i not in stop_words]))

clean_sentences

clean_sentences=[remove_stopwords(sent.split())for sent in clean_sentences]

clean_sentences

!wget http://nlp.stanford.edu/data/glove.6B.zip

!unzip glove*.zip

word_embedding={}
f=open("/content/glove.6B.100d.txt",encoding="utf-8")
for line in f:
  values=line.split()
  word=values[0]
  vectors=np.array(values[1:],dtype="float32")
  word_embedding[word]=vectors
f.close

sentence_vectors=[]
for i in clean_sentences:
  if(len(i)>0):
    v=sum([word_embedding.get(w,np.zeros((100,))) for w in i.split()])/len(i.split())+0.01
  else:
    v=np.zeros((100,))
  sentence_vectors.append(v)

sim_mat=np.zeros([len(sentences), len(sentences)])

from sklearn.metrics.pairwise import cosine_similarity

for i in range(len(sentences)):
  for j in range(len(sentences)):
    if(i!=j):
      sim_mat[i][j]=cosine_similarity(sentence_vectors[i].reshape(1,100),sentence_vectors[j].reshape(1,100))[0,0]

sim_mat.shape

import networkx as nx
nx_graph=nx.from_numpy_array(sim_mat)
scores=nx.pagerank(nx_graph)

nx.draw(nx_graph)

nx.draw(nx_graph,with_labels=True)

ranked_sent=sorted(((scores[i],s) for i,s in enumerate(sentences)),reverse=True)

top=5

for i in range(top):
  print(ranked_sent[i][1])

